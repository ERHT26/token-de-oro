<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<title>Token de Oro ‚Äì Bal√≥n de Oro 2024</title>
<style>
  body { font-family: sans-serif; padding: 20px; }
  table { border-collapse: collapse; width: 100%; max-width: 900px; margin-bottom: 20px;}
  th, td { border: 1px solid #ccc; padding: 8px; text-align: center; vertical-align: top; }
  th { background: #ffd700; }
  #winner { font-size: 1.2em; font-weight: bold; margin-top: 20px; }
</style>
</head>
<body>

<h2>üèÜ Token de Oro ‚Äì Finalistas Bal√≥n de Oro 2024</h2>
<table id="results">
  <tr>
    <th>Jugador</th>
    <th>Desglose de Puntos</th>
    <th>Total Puntos</th>
  </tr>
</table>

<div id="winner"></div>

<script>
  const API_KEY = '6308d4db454108bc9e980a1784362264';

  const players = [
    { name: 'Rodri', id: 44 },
    { name: 'Vin√≠cius Jr', id: 762 },
    { name: 'Jude Bellingham', id: 129718 }
  ];

  // Puntuaciones seg√∫n tu sistema
  const pointsScheme = {
    goals: 14,
    assists: 8,
    dribblesSuccessful: 7,       // No disponible en API, poner 0 o manual
    shotsOnTargetNoGoal: 3,
    // Bonificaciones por tipo de gol (no vienen en API, ejemplo para 0)
    bonusDirectCorner: 6,
    bonusLongDistance: 6,
    bonusAcrobatic: 5,
    bonusFreeKick: 4,
    bonusOutsideArea: 4,
    bonusInsideArea: 2,
    bonusHeader: 3,
    bonusPenalty: 2,
    // Defensivas
    saves: 10,                   // atajadas
    ballRecoveries: 7,           // no disponible, poner 0 o manual
    successfulTacklesBonus: 2,   // no disponible, poner 0 o manual
    // Bonificaciones atajadas (no vienen en API, ejemplo 0)
    bonusPenaltySave: 6,
    bonusAcrobaticSave: 5,
    bonusCloseRangeSave: 4,
    bonusOutsideAreaSave: 3,
    bonusAerialSave: 3,
    // General
    matchesPlayed: 5,
    captainLeadership: 3,       // no disponible en API, manual
    passesCompletedRival: 0.1,  // 1 punto cada 10 pases (no disponible)
    kmRun: 1,                   // no disponible
    // Fair play
    foulsCommitted: -2,         // no disponible
    redCards: -8,
    yellowCards: -4,
    simulation: -5,             // no disponible
    noFoulsBonus: 2             // no disponible
  };

  // Obtener estad√≠sticas del jugador por id
  async function getStats(playerId) {
    const url = `https://v3.football.api-sports.io/players?id=${playerId}&season=2023`;
    const resp = await fetch(url, {
      headers: { 'x-apisports-key': API_KEY }
    });
    const data = await resp.json();
    if (!data.response || data.response.length === 0) return null;
    return data.response[0].statistics[0];
  }

  function calcPoints(stats) {
    if (!stats) return { total: 0, details: {} };

    // Asumamos regates, recuperaciones, etc. como 0 porque no est√°n en API
    const dribbles = 0;
    const recoveries = 0;
    const successfulTackles = 0;
    const captain = false; // no sabemos si es capit√°n
    const passesCompletedRival = 0;
    const kmRun = 0;
    const fouls = 0;
    const simulation = 0;
    const noFouls = false;

    let details = {};
    let total = 0;

    // Goles
    details.goals = stats.goals.total || 0;
    total += details.goals * pointsScheme.goals;

    // Asistencias
    details.assists = stats.goals.assists || 0;
    total += details.assists * pointsScheme.assists;

    // Regates exitosos (no disponible)
    details.dribbles = dribbles;
    total += dribbles * pointsScheme.dribblesSuccessful;

    // Tiros al arco (sin gol)
    // tiros a puerta - goles
    const shotsOn = stats.shots.on || 0;
    const shotsNoGoal = shotsOn - details.goals;
    details.shotsOnTargetNoGoal = shotsNoGoal > 0 ? shotsNoGoal : 0;
    total += details.shotsOnTargetNoGoal * pointsScheme.shotsOnTargetNoGoal;

    // Bonificaciones por tipo de gol - no disponibles, ponemos 0
    details.bonusGoals = 0;

    // Atajadas (portero)
    details.saves = stats.goals.saves || 0;
    total += details.saves * pointsScheme.saves;

    // Recuperaci√≥n bal√≥n y entrada exitosa (no disponibles)
    details.recoveries = recoveries;
    total += recoveries * pointsScheme.ballRecoveries;
    details.tacklesBonus = successfulTackles;
    total += successfulTackles * pointsScheme.successfulTacklesBonus;

    // Partidos jugados
    details.appearances = stats.games.appearences || 0;
    total += details.appearances * pointsScheme.matchesPlayed;

    // Liderazgo capit√°n (no disponible)
    details.captain = captain ? 1 : 0;
    total += captain ? pointsScheme.captainLeadership : 0;

    // Pases completados en campo rival (no disponible)
    details.passesCompletedRival = passesCompletedRival;
    total += passesCompletedRival * pointsScheme.passesCompletedRival;

    // Kil√≥metros recorridos (no disponible)
    details.kmRun = kmRun;
    total += kmRun * pointsScheme.kmRun;

    // Faltas cometidas (no disponible)
    details.fouls = fouls;
    total += fouls * pointsScheme.foulsCommitted;

    // Tarjetas amarillas y rojas
    details.yellowCards = stats.cards.yellow || 0;
    total += details.yellowCards * pointsScheme.yellowCards;

    details.redCards = stats.cards.red || 0;
    total += details.redCards * pointsScheme.redCards;

    // Simulaci√≥n (no disponible)
    details.simulation = simulation;
    total += simulation * pointsScheme.simulation;

    // Partidos sin faltas
    details.noFoulsBonus = noFouls ? 1 : 0;
    total += noFouls ? pointsScheme.noFoulsBonus : 0;

    return { total, details };
  }

  function formatDetails(details) {
    return `
      Goles: ${details.goals} √ó14 = ${details.goals * 14} pts<br>
      Asistencias: ${details.assists} √ó8 = ${details.assists * 8} pts<br>
      Regates exitosos: ${details.dribbles} √ó7 = ${details.dribbles * 7} pts<br>
      Tiros al arco (sin gol): ${details.shotsOnTargetNoGoal} √ó3 = ${details.shotsOnTargetNoGoal * 3} pts<br>
      Atajadas: ${details.saves} √ó10 = ${details.saves * 10} pts<br>
      Recuperaciones de bal√≥n: ${details.recoveries} √ó7 = ${details.recoveries * 7} pts<br>
      Entradas exitosas: ${details.tacklesBonus} √ó2 = ${details.tacklesBonus * 2} pts<br>
      Partidos jugados: ${details.appearances} √ó5 = ${details.appearances * 5} pts<br>
      Liderazgo como capit√°n: ${details.captain} √ó3 = ${details.captain * 3} pts<br>
      Pases completados en campo rival: ${details.passesCompletedRival} √ó0.1 = ${(details.passesCompletedRival * 0.1).toFixed(1)} pts<br>
      Kil√≥metros recorridos: ${details.kmRun} √ó1 = ${details.kmRun} pts<br>
      Faltas cometidas: ${details.fouls} √ó(-2) = ${details.fouls * -2} pts<br>
      Tarjetas amarillas: ${details.yellowCards} √ó(-4) = ${details.yellowCards * -4} pts<br>
      Tarjetas rojas: ${details.redCards} √ó(-8) = ${details.redCards * -8} pts<br>
      Simulaci√≥n: ${details.simulation} √ó(-5) = ${details.simulation * -5} pts<br>
      Partidos sin faltas: ${details.noFoulsBonus} √ó2 = ${details.noFoulsBonus * 2} pts
    `;
  }

  async function load() {
    const table = document.getElementById('results');
    let maxPoints = -Infinity;
    let winner = '';

    for (const p of players) {
      const stats = await getStats(p.id);
      if (!stats) {
        console.warn(`No hay datos para ${p.name}`);
        continue;
      }
      const { total, details } = calcPoints(stats);
      const row = table.insertRow();

      row.insertCell().textContent = p.name;
      row.insertCell().innerHTML = formatDetails(details);
      row.insertCell().textContent = total.toFixed(2);

      if (total > maxPoints) {
        maxPoints = total;
        winner = p.name;
      }
    }

    const winnerDiv = document.getElementById('winner');
    winnerDiv.textContent = `üèÖ Ganador: ${winner} con ${maxPoints.toFixed(2)} puntos.`;
  }

  load();
</script>

</body>
</html>
